# 📘 产品需求文档 (PRD) - Academic Rays (Full Flutter Version)

## 1. 产品概览

* **产品名称**：Academic Rays
* **核心理念**：打通“预习-记录-巩固”全链路，实现知识自动化归档与深度辅导。
* **技术栈选型**：
* **客户端**：**Flutter**（利用其强大的自绘引擎处理复杂的笔记标注与公式渲染）。
* **后端**：ASP.NET Core + 向量数据库 + Gemini API。



---

## 2. 核心功能模块详解

### 🟢 第一阶段：课前 (Pre-Class) —— 高效预习

* **智能资料归档 (Smart Filing)**：
* **功能**：用户拍摄或上传课件/PDF。
* **AI 逻辑**：自动识别内容并归类至对应学科（如“高等数学”）。


* **预习摘要与焦点提取 (Focus Extraction)**：
* **核心概念**：提取关键术语。
* **前置知识检查**：提示复习旧知识点。
* **预习清单**：根据用户可用时间（如 20 分钟）生成任务流。



### 🟡 第二阶段：课中 (In-Class) —— 自动化记录

* **课中快拍与实时归档**：
* **自动路由**：Flutter 端结合地理位置或课表，实现图片自动分类存储。
* **OCR 增强**：高精度识别手写体及 **LaTeX 复杂公式**。


* **智能笔记生成 (Smart Notes)**：
* **结构化重组**：将图片转化为层级分明的 Markdown 文档（含标题、公式、代码块）。
* **遗漏补全**：AI 分析笔记逻辑，自动标注并补全推导步骤。


* **知识联想 (Knowledge Linking)**：
* **双向链接**：在 Flutter 界面通过悬浮卡片展示关联知识（如点击“泰勒展开”跳转至旧笔记）。



### 🔴 第三阶段：课后 (Post-Class) —— 闭环反馈

* **智能批改与诊断 (AI Grading & Audit)**：
* **处理流程**：OCR 提取用户手写步骤，与标准路径比对。
* **反馈输出**：在 Flutter 界面通过红色高亮指出遗漏步骤或逻辑错误，并给出预估分。


* **动态任务流 (Dynamic Workflow)**：
* **待办集成**：错题自动加入 Flutter 本地待办清单。
* **个性化推题**：AI 检索 3-5 道变式题，确保掌握逻辑。



### 🟣 全局功能：Academic Ray (AI 助手)

* **Gemini 式辅导**：全局 Chat 浮窗，支持“苏格拉底式”或“直球式”导师角色切换。
* **文档问答**：支持针对笔记或课件内容进行提问（RAG 模式）。

---

## 3. 技术实现建议 (Flutter 专项)

| 功能模块 | Flutter 实现方案 |
| --- | --- |
| **UI 开发** | 利用 Flutter 自绘引擎处理复杂的自定义 UI，如在图片上画圈批改。 |
| **公式渲染** | 推荐 `flutter_math_fork` 插件，确保 LaTeX 解析的性能与美观。 |
| **本地存储** | 使用 `Drift` (SQL) 或 `Isar` (NoSQL) 存储笔记索引与本地待办。 |
| **网络请求** | 使用 `Dio` 插件处理图片二进制流上传，配合 `MultipartFile` 优化流量。 |

---

## 4. 下一步行动建议

1. **API 验证**：立即测试 Gemini 对“手写数学题纠错”的 Prompt 表现。
2. **原型开发**：使用 Flutter 编写一个“拍照 -> 后端 OCR -> Markdown 渲染”的最小可行性 Demo。
3. **数据库建模**：设计 `Subject`、`Note`、`Problem` 与 `KnowledgePoint` 的关联模型。
